---
title: "PlayingWithData"
author: "Colleen Minnihan"
date: "3/29/2021"
output: html_document
---

```{r}
library(fivethirtyeight)
library(dplyr)
library(tidytext)
library(tidyr)
library(tidyverse)
library(ggplot2)

troll_tweets_news <- read.csv("IRAhandle_tweets_12.csv") #seems to be imitating news sources
troll_tweets_left <- read.csv("IRAhandle_tweets_5.csv") #seems to be imitating liberals
troll_tweets_right <- read.csv("IRAhandle_tweets_8.csv") #seems to be imitating Trump supporter

dim(troll_tweets)

#cleaning data
troll_tweets1 <- troll_tweets_news %>%
  filter(language == 'English') #only tweets that are in English
  
troll_tweets_left <- troll_tweets_left %>%
  filter(language == 'English')

troll_tweets_right <- troll_tweets_right %>%
  filter(language == 'English')

troll_tweets
troll_tweets_left
troll_tweets_right
```

```{r}
#separate tweet so that each row gets an individual word: unnest tokens

troll_tweets1 <- troll_tweets1 %>%
  unnest_tokens(word,content)

troll_tweets1

#get rid of stopwords (the, and, etc.)
troll_tweets1 <- troll_tweets1 %>%
  anti_join(stop_words) %>%
  filter(word != 'https', word != 't.co') #get rid of https and t.co

troll_tweets1 %>%
  count(word) %>%
  slice_max(order_by = n, n = 100)
```

```{r}
#get rid of: 2, rt, 1, amp, 3, http, 5, 4, 10

troll_tweets2 <- troll_tweets1 %>%
  mutate(word = str_extract(word,"[a-z']+")) %>%
  filter(word != '1', word != '2', word != '3', word != '4', word != '5', word != '10', word != 'rt', word != 'amp', word != 'http', !(word %in% letters))

letters
```

```{r}
troll_tweets_small <- troll_tweets2 %>%
  count(word) %>%
  slice_max(order_by = n, n = 50)

ggplot(troll_tweets_small, aes(y = fct_reorder(word,n), x = n)) +
  geom_col()
```

Make wordcloud
```{r}
library(textdata)
library(reshape2)
library(wordcloud)

troll_tweets_100 <- troll_tweets2 %>%
  count(word) %>%
  slice_max(order_by = n, n = 100)

troll_tweets_100 %>%
  with(wordcloud(word, n, max.words = 100))

troll_tweets2 %>%
  inner_join(get_sentiments("bing")) %>%
  count(word, sentiment, sort = TRUE) %>%
  acast(word ~ sentiment, value.var = "n", fill = 0) %>%
  comparison.cloud(colors = c("red", "green"),
                   max.words = 100)

wordcloud(words = troll_tweets_100$word, freq = troll_tweets_100$n, min.freq = 1,
          max.words=200, random.order=FALSE, rot.per=0.35, 
          colors=brewer.pal(8, "Dark2"))
```

```{r}
troll_tweets_sentiment <- troll_tweets2 %>%
  inner_join(get_sentiments("bing")) %>%
  count(sentiment)

#count negative and positive words
troll_tweets_sentiment

get_sentiments("bing")
```




